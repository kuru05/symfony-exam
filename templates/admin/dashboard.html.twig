{% extends 'base.html.twig' %}

{% block title %}Dashboard Admin - EventHub
{% endblock %}

{% block body %}
	<div class="container py-5">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h1 class="h2 fw-bold text-primary">Tableau de bord Administrateur</h1>
			<div class="btn-group">
				<a href="{{ path('app_admin_users') }}" class="btn btn-outline-primary">Gérer les utilisateurs</a>
				<a href="{{ path('app_admin_events') }}" class="btn btn-outline-primary">Gérer les événements</a>
				<a href="{{ path('app_admin_reservations') }}" class="btn btn-outline-primary">Gérer les réservations</a>
			</div>
		</div>

		<!-- Stats Cards -->
		<div class="row g-4 mb-5">
			<div class="col-md-4">
				<div class="card shadow-sm border-0 border-start border-primary border-4">
					<div class="card-body">
						<h5 class="text-muted text-uppercase small fw-bold">Utilisateurs</h5>
						<p class="display-4 fw-bold text-dark mb-0">{{ totalUsers }}</p>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card shadow-sm border-0 border-start border-success border-4">
					<div class="card-body">
						<h5 class="text-muted text-uppercase small fw-bold">Événements</h5>
						<p class="display-4 fw-bold text-dark mb-0">{{ totalEvents }}</p>
					</div>
				</div>
			</div>
			<div class="col-md-4">
				<div class="card shadow-sm border-0 border-start border-warning border-4">
					<div class="card-body">
						<h5 class="text-muted text-uppercase small fw-bold">Réservations</h5>
						<p class="display-4 fw-bold text-dark mb-0">{{ totalReservations }}</p>
					</div>
				</div>
			</div>
		</div>

		<!-- Recent Activity -->
		<div class="card shadow-sm border-0">
			<div class="card-header bg-white py-3">
				<h5 class="mb-0 fw-bold">Dernières réservations</h5>
			</div>
			<div class="card-body p-0">
				<div class="table-responsive">
					<table class="table table-hover mb-0 align-middle">
						<thead class="bg-light">
							<tr>
								<th class="ps-4">Utilisateur</th>
								<th>Événement</th>
								<th>Places</th>
								<th>Date réservation</th>
								<th class="text-end pe-4">Action</th>
							</tr>
						</thead>
						<tbody>
							{% for reservation in lastReservations %}
								<tr>
									<td class="ps-4">{{ reservation.user.email }}</td>
									<td>{{ reservation.event.title }}</td>
									<td>
										<span class="badge bg-info text-dark rounded-pill">{{ reservation.guestCount }}</span>
									</td>
									<td>{{ reservation.createdAt|date('d/m/Y H:i') }}</td>
									<td class="text-end pe-4">
										<form method="post" action="{{ path('app_admin_reservation_delete', {'id': reservation.id}) }}" onsubmit="return confirm('Êtes-vous sûr ?');" style="display: inline-block;">
											<button class="btn btn-sm btn-outline-danger">Annuler</button>
										</form>
									</td>
								</tr>
							{% else %}
								<tr>
									<td colspan="5" class="text-center py-4">Aucune réservation récente.</td>
								</tr>
							{% endfor %}
						</tbody>
					</table>
				</div>
			</div>
			<div class="card-footer bg-white text-center py-3">
				<a href="{{ path('app_admin_reservations') }}" class="text-decoration-none fw-bold">Voir toutes les réservations</a>
			</div>
		</div>
	</div>
{% endblock %}
